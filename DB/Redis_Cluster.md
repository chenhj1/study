# Redis Cluster

Redis模式主要有两种：
1. 主从模式。
2. 集群模式。

本文将介绍集群模式。

## 1. 集群模式概念
集群模式（Cluster）由多台主节点、多台从节点组成。与主从模式（Master-slave）最大的区别是：集群模式可以分片。
数据按照一定的hash算法分散在各个主节点上，突破了主从模式单节点（只有一台主节点）的内存限制，另外每个分片都可以进行读写服务，进一步提高了负载。

集群模式的可用性也比主从模式有所提高，任意节点发生故障时，集群仍然可以对外提供服务。

## 2. Redis集群模式原理
Redis集群中，通过“槽”实现数据分区。集群有16384个槽，槽是数据管理和迁移的基本单位。当数据库中的16384个槽都分配了节点时，集群处于上线状态（ok）；
如果有任意一个槽没有分配节点，则集群处于下线状态（fail）。

### 1.数据分区方案
数据分区有“顺序分区”、“哈希分区”等，其中哈希分区由于有天然的随机性，使用广泛。Redis的分区方案采用的哈希分区。

衡量分区方法好坏的标准主要有两个：
* 数据是否分布均匀
* 增加或删除节点，对数据分布影响程度

哈希取余分区，可以保证key的落在哪个分区的随机性，

